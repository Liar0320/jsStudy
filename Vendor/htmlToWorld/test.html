<!doctype html>
<html>

<head>
    <script src="jquery-3.2.1.min.js"></script>
    <script src="FileSaver.js"></script>
    <script src="jquery.wordexport.js"></script>
</head>

<body>
    <input type="button" value="上传" />
    <div id="page-content">
    </div>
    <a class="word-export" href="javascript:void(0)"> 导出 </a>
    <script type="text/javascript">
        var gsshxxTransfer = {
            "company": "西游记",
            "DOCBH": "Hz2018202",
            "international": "西游记国际版",
            "domestic": "西游记国内版",
            "verifyTime": "2018-2-3",
            "verifyAddress": "不周山山脚",
            "delegateAndType": "仙侠传",
            "shzcy": [
                {
                    "name": "唐僧",
                    "verifyId": "000",
                    "verifyUnit": "大慈恩寺",
                    "lawOfId": "000000",
                    "phoneNumber": "12345678900"
                }, {
                    "name": "孙悟空",
                    "verifyId": "001",
                    "verifyUnit": "花果山",
                    "lawOfId": "000001",
                    "phoneNumber": "12345678901"
                }, {
                    "name": "猪八戒",
                    "verifyId": "002",
                    "verifyUnit": "天庭",
                    "lawOfId": "000002",
                    "phoneNumber": "12345678902"
                }, {
                    "name": "沙悟净",
                    "verifyId": "003",
                    "verifyUnit": "通天河",
                    "lawOfId": "000003",
                    "phoneNumber": "12345678903"
                }
            ],
            "person": "魔尊重楼",
            "phoneNumber": "11111111111",
            "year": "2018",
            "M": "8",
            "D": "30",
            "schedulingProgram": "《西游记》是中国古代第一部浪漫主义章回体长篇神魔小说。现存明刊百回本《西游记》均无作者署名。清代学者吴玉搢等首先提出《西游记》作者是明代吴承恩 [1]  。这部小说以“唐僧取经”这一历史事件为蓝本，通过作者的艺术加工，深刻地描绘了当时的社会现实。全书主要描写了孙悟空出世及大闹天宫后，遇见了唐僧、猪八戒和沙僧三人，西行取经，一路降妖伏魔，经历了九九八十一难，终于到达西天见到如来佛祖，最终五圣成真的故事。"

        }
        function gsshxxFnc($DOM, formData) {
            var gsshxx = '      <div  class=\'Section1\'>\n<p style="font-size:18pt; line-height:150%; margin:0pt; orphans:0; text-align:center; widows:0">\n    <!-- <span style="font-family:\u5B8B\u4F53; font-size:18pt; font-weight:bold">s</span> -->\n    <span style="font-family:\u5B8B\u4F53; font-size:18pt; font-weight:bold">\u516C\u53F8\u5BA1\u6838\u5B89\u6392\u65B9\u6848</span>\n</p>\n<div style="text-align:center">\n    <table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin:0 auto">\n        <tr style="height:27.7pt">\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:50.35pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u516C\u53F8</span>\n                                    </p>\n            </td>\n            <td colspan="3" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:205.15pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{company}}</span>\n                </p>\n            </td>\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.55pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">DOC\u7F16\u53F7</span>\n                </p>\n            </td>\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:74.25pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{DOCBH}}</span>\n                </p>\n            </td>\n        </tr>\n        <tr style="height:39.25pt">\n            <td rowspan="2" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:50.35pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5BA1\u6838\u79CD\u7C7B</span>\n                </p>\n            </td>\n            <td colspan="3" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:205.15pt">\n                <p style="margin:0pt; orphans:0; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u56FD\u9645\uFF1A{{international}}</span>\n                </p>\n            </td>\n            <td rowspan="2" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.55pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5BA1\u6838\u65F6\u95F4</span>\n                </p>\n            </td>\n            <td rowspan="2" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:74.25pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{verifyTime}}</span>\n                </p>\n            </td>\n        </tr>\n        <tr style="height:39.25pt">\n            <td colspan="3" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:205.15pt">\n                <p style="margin:0pt; orphans:0; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u56FD\u5185\uFF1A{{domestic}}</span>\n                </p>\n            </td>\n        </tr>\n        <tr style="height:24pt">\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:50.35pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5BA1\u6838\u5730\u70B9</span>\n                </p>\n            </td>\n            <td colspan="3" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:205.15pt">\n                <p style="margin:0pt; orphans:0; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{verifyAddress}}</span>\n                </p>\n            </td>\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.55pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u4EE3\u8868\u8239\u53CA\u5BA1\u6838\u79CD\u7C7B</span>\n                </p>\n            </td>\n            <td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:74.25pt">\n                <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{delegateAndType}}</span>\n                </p>\n            </td>\n        </tr>\n        <tr style="height:26.85pt" id=\'shzcy\'>\n        </tr>\n        <tr style="height:166pt">\n            <td colspan="6" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:top; width:431.7pt">\n                <p style="font-size:10.5pt; line-height:150%; margin:0pt; orphans:0; text-align:justify; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5177\u4F53\u65E5\u7A0B\u5B89\u6392\u53CA\u76F8\u5173\u8BF4\u660E\uFF1A</span>\n                </p>\n                <p style="font-size:10.5pt; line-height:150%; margin:0pt; orphans:0; text-align:justify; widows:0">\n                    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{schedulingProgram}}</span>\n                </p>\n            </td>\n        </tr>\n        <tr style="height:0pt">\n            <td style="width:61.15pt; border:none"></td>\n            <td style="width:80.1pt; border:none"></td>\n            <td style="width:55pt; border:none"></td>\n            <td style="width:80.85pt; border:none"></td>\n            <td style="width:80.35pt; border:none"></td>\n            <td style="width:85.05pt; border:none"></td>\n        </tr>\n    </table>\n</div>\n<p style="margin:0pt; text-indent:3.35pt">\n    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5236\u5B9A\u4EBA\uFF1A{{person}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\n    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u8054\u7CFB\u7535\u8BDD\uFF1A{{phoneNumber}} &nbsp;&nbsp;&nbsp;&nbsp; </span>\n    <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{year}}\u5E74{{M}}\u6708{{D}}\u65E5</span>\n</p>\n<p style="margin:0pt; text-indent:3.25pt">\n    <span style="font-family:\u4EFF\u5B8B_GB2312; font-size:10.5pt">\uFF08\u6CE8\uFF1A1.\u201C\u5BA1\u6838\u79CD\u7C7B\u201D\u5E94\u540C\u65F6\u5907\u6CE8\u5BA1\u6838\u6240\u8986\u76D6\u8239\u8236\u7684\u56FD\u7C4D\u53CA\u8239\u79CD\uFF0C\u82E5\u4E3A\u5E74\u5EA6\u5BA1\u6838\uFF0C\u5219\u8FD8\u5E94\u6807\u660E\u5BA1\u6838\u6B21\u6570\u3002\u5982\u201C\u56FD\u9645\uFF1A\u7B2C2\u6B21\u5E74\u5EA6\u5BA1\u6838\uFF08\u4E2D\u56FD\u7C4D\u3001\u4E2D\u56FD\u9999\u6E2F\u7C4D\u6563\u8D27\u8239\u3001\u5176\u4ED6\u8D27\u8239\uFF09\u201D\uFF1B2.\u82E5\u8239\u8236\u4EC5\u4F5C\u4EE3\u8868\u8239\u5BA1\u6838\uFF0C\u5219\u201C\u4EE3\u8868\u8239\u53CA\u5BA1\u6838\u79CD\u7C7B\u201D\u586B\u5199\u8239\u540D\u540E\u5907\u6CE8\u201C\u4EC5\u4F5C\u4EE3\u8868\u8239\u201D\uFF1B3.\u6B64\u8868\u76D6\u7AE0\u540E\u53D1\u7ED9\u516C\u53F8\uFF0C\u5404\u5C40\u5185\u90E8\u6D41\u8F6C\u7A0B\u5E8F\u53CA\u65B9\u5F0F\u81EA\u5B9A\u3002\uFF09</span>\n</p>\n</div>';
            var shzcyxxHead = ' <tr style="height:26.85pt">\n<td rowspan="{{rowspan}}" style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:50.35pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5BA1\u6838\u7EC4\u6210\u5458</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.3pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u59D3\u540D</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:44.2pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u5BA1\u6838\u8EAB\u4EFD</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:70.05pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u6240\u5728\u5355\u4F4D</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.55pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u6267\u6CD5\u8BC1\u53F7</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:74.25pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">\u8054\u7CFB\u7535\u8BDD</span>\n    </p>\n</td>\n</tr>';
            var shzcyxx = ' <tr style="height:26.85pt">\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.3pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{name}}</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:44.2pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{verifyId}}</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:70.05pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{verifyUnit}}</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:69.55pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{lawOfId}}</span>\n    </p>\n</td>\n<td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:1pt; border-left-color:#000000; border-left-style:solid; border-left-width:1pt; border-right-color:#000000; border-right-style:solid; border-right-width:1pt; border-top-color:#000000; border-top-style:solid; border-top-width:1pt; padding-left:4.9pt; padding-right:4.9pt; vertical-align:middle; width:74.25pt">\n    <p style="margin:0pt; orphans:0; text-align:center; widows:0">\n        <span style="font-family:\u5B8B\u4F53; font-size:10.5pt">{{phoneNumber}}</span>\n    </p>\n</td>\n</tr>';


            $DOM.append(exChangeGsshxx(gsshxx, formData));
            shzcyxxHead = shzcyxxHead.replace('{{rowspan}}', formData.shzcy.length + 1);
            shzcyxxHead += exChangeShzcyxx(shzcyxx, formData.shzcy);
            $("#shzcy").replaceWith(shzcyxxHead);
            return $DOM;
            // $DOM.wordExport();
            // $DOM = null;

            function exChangeGsshxx(gsshxx, gsshxxData) {
                var obj = ['company', 'DOCBH', 'international', 'verifyTime', 'verifyAddress', 'delegateAndType', 'domestic','person', 'phoneNumber', 'year', 'M', 'D', 'schedulingProgram'];
                for (var i = 0; i < obj.length; i++) {
                    if (gsshxxData[obj[i]]) {
                        gsshxx = gsshxx.replace('{{' + obj[i] + '}}', gsshxxData[obj[i]]);
                    }
                }
                return gsshxx;
            }

            function exChangeShzcyxx(shzcyxx, shzcyxxData) {
                var result = '';
                var obj = ['name', 'verifyId', 'verifyUnit', 'lawOfId', 'phoneNumber'];
                for (var i = 0; i < shzcyxxData.length; i++) {
                    var temp = shzcyxxData[i];
                    var tempShzcyxx = shzcyxx;
                    for (var j = 0; j < obj.length; j++) {
                        if (temp[obj[j]]) {
                            tempShzcyxx = tempShzcyxx.replace('{{' + obj[j] + '}}', temp[obj[j]]);

                        }
                    }
                    result += tempShzcyxx;
                }
                return result
            }
        }

        jQuery(document).ready(function ($) {
            $("a.word-export").click(function (event) {
                var $DOM = gsshxxFnc($("#page-content"), gsshxxTransfer);
                $DOM.wordExport();
                $DOM = null;
            });
        });
    </script>
</body>

</html>