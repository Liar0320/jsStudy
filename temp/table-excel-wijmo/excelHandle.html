<!-- https://www.cnblogs.com/bubugao/p/js4.html     使用纯前端JavaScript 实现Excel IO-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>导入excel数据</title>
    <script src="./wijmo/wijmo.min.js"></script>
    <script src="./wijmo/wijmo.xlsx.min.js"></script>
    <script src="./jszip.min.js"></script>
</head>
<body>
    <input type="file" value='请选择文件' onchange="fileChange(this)">
</body>
</html>
<script>
    window.addEventListener('load',init);
    function init(){
        
    }
    function fileChange(obj){
        let file = obj.files[0];
        let reader = new FileReader();
        reader.onload = function(e){
            if(e.target.readyState !==2) new Error('input file 缓存数据出错');
            workbook = new wijmo.xlsx.Workbook();
                workbook.load(reader.result);
                var collectionView = new wijmo.collections.CollectionView(getCollectionView(workbook));
                console.log(collectionView._view);
        }
        reader.readAsDataURL(file);
    }
    var getCollectionView = function (workbook) {
        var collectionView = [];
        if (workbook) {
            var sheet = workbook.sheets[0];
            var header = [];
            for (var i = 0, length = sheet.rows.length; i < length; i++) {
                var row = sheet.rows[i];
                var rowArray = {};
                for (var j = 0, jLength = row.cells.length; j < jLength; j++) {
                    var cell = row.cells[j];
                    if (i === 0) {
                        header.push(cell.value);
                    }
                    else {
                        rowArray[header[j]] = cell.value;
                    }
                }
                if (i !== 0) {
                    collectionView.push(rowArray);
                }
            }
        }
        return collectionView;
    }
</script>